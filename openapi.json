{
  "openapi": "3.0.1",
  "info": {
    "title": "LabApiGateway",
    "version": "1.0.0",
    "description": "The entrypoint for all services created by the data science team."
  },
  "servers": [
    {
      "url": "https://brvw7rouq9.execute-api.eu-west-1.amazonaws.com/{basePath}",
      "description": "Staging server.",
      "variables": {
        "basePath": {
          "default": "dev"
        }
      }
    }
  ],
  "paths": {
    "/search/v1/indexing-status": {
      "get": {
        "parameters": [
          {
            "name": "node-uuids",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "security": [
          {
            "api_key": []
          }
        ],
        "x-amazon-apigateway-integration": {
          "type": "aws_proxy",
          "httpMethod": "POST",
          "uri": "arn:aws:apigateway:eu-west-1:lambda:path/2015-03-31/functions/arn:aws:lambda:eu-west-1:666774207884:function:Staging-IntelligentSearch-IndexingStatusQueryingLa-smEFC4cQ1fgJ/invocations",
          "passthroughBehavior": "when_no_match"
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/searchIndexingStatusResponse"
                }
              }
            }
          }
        }
      }
    },
    "/search/v1/search": {
      "post": {
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/searchQuery"
              }
            }
          }
        },
        "security": [
          {
            "api_key": []
          }
        ],
        "x-amazon-apigateway-integration": {
          "type": "aws_proxy",
          "httpMethod": "POST",
          "uri": "arn:aws:apigateway:eu-west-1:lambda:path/2015-03-31/functions/arn:aws:lambda:eu-west-1:666774207884:function:Staging-IntelligentSearch-IntelligentSearchLambda6-xs6XNxu80s5s/invocations",
          "passthroughBehavior": "when_no_match"
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/searchResponse"
                }
              }
            }
          }
        }
      }
    },
    "/search/v1/search_and_summarize": {
      "post": {
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/searchQuery"
              }
            }
          }
        },
        "security": [
          {
            "api_key": []
          }
        ],
        "x-amazon-apigateway-integration": {
          "type": "aws_proxy",
          "httpMethod": "POST",
          "uri": "arn:aws:apigateway:eu-west-1:lambda:path/2015-03-31/functions/arn:aws:lambda:eu-west-1:666774207884:function:Staging-IntelligentSearch-IntelligentSearchLambda6-xs6XNxu80s5s/invocations",
          "passthroughBehavior": "when_no_match"
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/searchSummarizeResponse"
                }
              }
            }
          }
        }
      }
    },
    "/concept_tracks/v1/files/{file_id}/status": {
      "get": {
        "parameters": [
          {
            "name": "file_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "example": "lab/2fc3f792-cd71-45c7-a8dd-bd23f4639319/Sun-Dog-Car-MIX_multiple_models"
          }
        ],
        "security": [
          {
            "api_key": []
          }
        ],
        "x-amazon-apigateway-integration": {
          "type": "aws_proxy",
          "httpMethod": "POST",
          "uri": "arn:aws:apigateway:eu-west-1:lambda:path/2015-03-31/functions/arn:aws:lambda:eu-west-1:666774207884:function:Staging-concept-tracks-concepttrackstatuslambdaB8F-6eywMtjkHcsX/invocations",
          "passthroughBehavior": "when_no_match"
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/conceptTracksIndexingStatusResponse"
                }
              }
            }
          }
        }
      }
    },
    "/concept_tracks/v1/files/{file_id}/nodes": {
      "get": {
        "parameters": [
          {
            "name": "file_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "example": "lab/2fc3f792-cd71-45c7-a8dd-bd23f4639319/Sun-Dog-Car-MIX_multiple_models"
          },
          {
            "name": "model_id",
            "in": "query",
            "schema": {
              "type": "string"
            },
            "example": "522c5bce-ba13-432c-a429-6b4e99e14c81"
          }
        ],
        "security": [
          {
            "api_key": []
          }
        ],
        "x-amazon-apigateway-integration": {
          "type": "aws_proxy",
          "httpMethod": "POST",
          "uri": "arn:aws:apigateway:eu-west-1:lambda:path/2015-03-31/functions/arn:aws:lambda:eu-west-1:666774207884:function:Staging-concept-tracks-concepttracknodessuggestion-Szav0LwWyC0y/invocations",
          "passthroughBehavior": "when_no_match"
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/conceptTracksNodeSuggestionsResponse"
                },
                "examples": {
                  "node_suggestion_response": {
                    "value": {
                      "title": "sun dog",
                      "id": "e4cc04f3-f5ed-49f1-be63-482204f14180",
                      "pages": [
                        0
                      ]
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/concept_tracks/v1/files/{file_id}/nodes/{node_id}": {
      "get": {
        "parameters": [
          {
            "name": "file_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "example": "lab/2fc3f792-cd71-45c7-a8dd-bd23f4639319/Sun-Dog-Car-MIX_multiple_models"
          },
          {
            "name": "node_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "example": "0ffa6f60-d8ea-48f7-a464-737c698609e7"
          },
          {
            "name": "model_id",
            "in": "query",
            "schema": {
              "type": "string"
            },
            "example": "522c5bce-ba13-432c-a429-6b4e99e14c81"
          }
        ],
        "security": [
          {
            "api_key": []
          }
        ],
        "x-amazon-apigateway-integration": {
          "type": "aws_proxy",
          "httpMethod": "POST",
          "uri": "arn:aws:apigateway:eu-west-1:lambda:path/2015-03-31/functions/arn:aws:lambda:eu-west-1:666774207884:function:Staging-concept-tracks-concepttracknodesdetailslam-RJtYVfCrSm1V/invocations",
          "passthroughBehavior": "when_no_match"
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/conceptTracksNodeDetailsResponse"
                }
              }
            }
          }
        }
      }
    },
    "/concept_tracks/v1/models": {
      "get": {
        "security": [
          {
            "api_key": []
          }
        ],
        "x-amazon-apigateway-integration": {
          "type": "aws_proxy",
          "httpMethod": "POST",
          "uri": "arn:aws:apigateway:eu-west-1:lambda:path/2015-03-31/functions/arn:aws:lambda:eu-west-1:666774207884:function:Staging-concept-tracks-concepttrackendpointslambda-y6iDgE074dpC/invocations",
          "passthroughBehavior": "when_no_match"
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/conceptTracksModelRequestResponse"
                },
                "examples": {
                  "models_response_with_default": {
                    "value": {
                      "id": "e4cc04f3-f5ed-49f1-be63-482204f14180",
                      "name": "LDA",
                      "description": "desc",
                      "default": true
                    }
                  },
                  "models_response_without_default": {
                    "value": {
                      "id": "fe111234-f5ed-49f1-be63-482204f14180",
                      "name": "Transformers",
                      "description": "desc"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/pdf_2_text/v1/files/{file_id}/status": {
      "get": {
        "parameters": [
          {
            "name": "file_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "example": "lab/2fc3f792-cd71-45c7-a8dd-bd23f4639319/Sun-Dog-Car-MIX_multiple_models"
          }
        ],
        "security": [
          {
            "api_key": []
          }
        ],
        "x-amazon-apigateway-integration": {
          "type": "aws_proxy",
          "httpMethod": "POST",
          "uri": "arn:aws:apigateway:eu-west-1:lambda:path/2015-03-31/functions/arn:aws:lambda:eu-west-1:666774207884:function:Staging-pdf-2-text-pdf2textstatuslambda187E8141-UvCepfawxNV8/invocations",
          "passthroughBehavior": "when_no_match"
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/pdf2TextIndexingStatusResponse"
                }
              }
            }
          }
        }
      }
    },
    "/question_generation/v1": {
      "post": {
        "requestBody": {
          "description": "Endpoint for the question generation service",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/questionGenerationQuery"
              }
            }
          }
        },
        "security": [
          {
            "api_key": []
          }
        ],
        "x-amazon-apigateway-integration": {
          "type": "aws_proxy",
          "httpMethod": "POST",
          "uri": "arn:aws:apigateway:eu-west-1:lambda:path/2015-03-31/functions/arn:aws:lambda:eu-west-1:666774207884:function:Staging-QGCdkStack-QuestionGenerationLambdaB5F6D33-ASsGg7bsslnl/invocations",
          "passthroughBehavior": "when_no_match"
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "oneOf": [
                    {
                      "$ref": "#/components/schemas/questionGenerationResponseMultipleQuestions"
                    },
                    {
                      "$ref": "#/components/schemas/questionGenerationResponseMCQs"
                    }
                  ]
                },
                "examples": {
                  "mcq_response": {
                    "value": {
                      "questions": [
                        "Which theory did Darwin discover?",
                        "Which theory did Einstein discover?"
                      ],
                      "mcq_answers": [
                        [
                          "Evolution.",
                          "Evaluation.",
                          "Optimization.",
                          "Quantization."
                        ],
                        [
                          "Relativity",
                          "Relativism",
                          "Relevantism",
                          "Irrelevantism"
                        ]
                      ],
                      "correct_answers": [
                        "Evolution.",
                        "Relativity"
                      ],
                      "explanations": [
                        "Darwin uncovered the theory of evolution.",
                        "Einstein discovered relativity, both special and general."
                      ]
                    }
                  },
                  "non-mcq_response": {
                    "value": {
                      "questions": [
                        "What is a corpus?",
                        "How the corpus should be constructed?",
                        "What data is used to build the corpus?"
                      ],
                      "answers": [
                        "A corpus is a collection of linguistic data.",
                        "It should be constructed so as to be balanced and representative.",
                        "Linguistic data which was not originally produced for the process of linguistic analysis."
                      ]
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/freeform_grader/v1": {
      "post": {
        "requestBody": {
          "description": "Endpoint for grading freeform text answers to questions",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/freeformGraderQuery"
              }
            }
          }
        },
        "security": [
          {
            "api_key": []
          }
        ],
        "x-amazon-apigateway-integration": {
          "type": "aws_proxy",
          "httpMethod": "POST",
          "uri": "arn:aws:apigateway:eu-west-1:lambda:path/2015-03-31/functions/arn:aws:lambda:eu-west-1:666774207884:function:Staging-freeform-demo-freeformgraderfunction86C87A-a4e4fl0K9QnD/invocations",
          "passthroughBehavior": "when_no_match"
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/freeformGraderResponse"
                },
                "examples": {
                  "freeform_grader_response": {
                    "value": {
                      "score": 20,
                      "explanation": "Student got the answer pretty wrong."
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/": {
      "x-amazon-apigateway-any-method": {
        "x-amazon-apigateway-integration": {
          "type": "mock",
          "passthroughBehavior": "when_no_match"
        }
      }
    }
  },
  "components": {
    "schemas": {
      "searchIndexingStatusResponse": {
        "properties": {
          "<node-uuid1-val>": {
            "type": "object",
            "properties": {
              "status": {
                "type": "string",
                "enum": [
                  "not_found",
                  "in_progress",
                  "success",
                  "failed",
                  "removed"
                ]
              }
            }
          },
          "<node-uuidi-val>": {
            "type": "object",
            "properties": {
              "status": {
                "type": "string",
                "enum": [
                  "not_found",
                  "in_progress",
                  "success",
                  "failed",
                  "removed"
                ]
              }
            }
          }
        },
        "required": [
          "status"
        ],
        "example": {
          "97f922c5-9f04-4afa-92d6-65aa93fa58e7": {
            "status": "in_progress"
          },
          "1df80389-7d6b-43dd-bff7-c6ed5de4efde": {
            "status": "failed"
          }
        }
      },
      "searchQuery": {
        "type": "object",
        "properties": {
          "user": {
            "type": "string"
          },
          "organization": {
            "type": "string"
          },
          "knowledge_spaces": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "node_types": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "query": {
            "type": "string"
          },
          "page_number": {
            "type": "integer"
          }
        },
        "example": {
          "user": "a34516af-8888-0000-aa66-793428dcf3e4",
          "organization": "a5a946b7-2603-49a9-8f52-c730a7b56002",
          "knowledge_spaces": [
            "d22206af-46f6-4482-bb06-793428dcf3e4",
            "b4288731-f301-4778-ac81-bd21ce84bdf5"
          ],
          "node_types": [
            "document",
            "video"
          ],
          "query": "beef pieces",
          "page_number": 1
        }
      },
      "searchResultsResponse": {
        "type": "object",
        "properties": {
          "uuid": {
            "type": "string"
          },
          "node_uuid": {
            "type": "string"
          },
          "node_kind": {
            "type": "string"
          },
          "score": {
            "type": "number",
            "format": "float64"
          },
          "original_text": {
            "type": "string"
          },
          "title": {
            "type": "string"
          },
          "start": {
            "type": "integer",
            "format": "int64"
          },
          "end": {
            "type": "integer",
            "format": "int64"
          },
          "page": {
            "type": "integer",
            "format": "int64"
          },
          "coordinates": {
            "type": "array",
            "items": {
              "type": "integer",
              "format": "int64"
            }
          },
          "href": {
            "type": "string"
          },
          "match": {
            "type": "string"
          }
        }
      },
      "searchResponse": {
        "type": "object",
        "properties": {
          "num_results": {
            "type": "integer",
            "format": "int64"
          },
          "exec_time": {
            "type": "number",
            "format": "float64"
          },
          "has_node_types": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "results": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/searchResultsResponse"
            }
          }
        },
        "example": {
          "query": "beef pieces",
          "num_results": 1,
          "exec_time": 3.69,
          "has_node_types": [
            "document",
            "video"
          ],
          "results": [
            {
              "uuid": "be07f02e-3f60-4d9e-b080-7dc9005afbd5",
              "node_uuid": "35d314c0-4542-4e72-939b-979ef07cb15f",
              "node_kind": "document",
              "space_uuid": "b4288731-f301-4778-ac81-bd21ce84bdf5",
              "score": 0.8899998,
              "original_text": "500g\t\r  of cheap beef pieces\t\r  (stewing\t\r  steak usually is cheap) ",
              "title": "Cooking with Ingredients",
              "start": null,
              "end": null,
              "page": 3,
              "coordinates": [
                [
                  72.12010192871094,
                  652.975341796875,
                  404.9890594482422,
                  669.2617340087891
                ]
              ],
              "href": null,
              "match": "High"
            }
          ]
        }
      },
      "referencesResult": {
        "type": "object",
        "properties": {
          "Reference number": {
            "type": "string"
          },
          "Node uuid": {
            "type": "string"
          }
        }
      },
      "searchSummarizeResponse": {
        "type": "object",
        "properties": {
          "summary": {
            "type": "string"
          },
          "returned_results": {
            "type": "string"
          },
          "references": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/referencesResult"
            }
          }
        },
        "example": {
          "summary": "I am a summary of some results",
          "returned_results": "These are some returned results",
          "references": [
            [
              {
                "Reference number": 1
              },
              {
                "Node uuid": 1234
              }
            ]
          ]
        }
      },
      "conceptTracksIndexingStatusResponse": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string",
            "enum": [
              "in_progress",
              "success",
              "failed"
            ]
          }
        },
        "required": [
          "status"
        ],
        "example": {
          "status": "in_progress"
        }
      },
      "conceptTracksNodeDetail": {
        "type": "object",
        "properties": {
          "node_title": {
            "type": "string"
          },
          "keywords": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "coordinates": {
            "type": "array",
            "items": {
              "type": "array",
              "items": {
                "type": "integer"
              }
            }
          }
        },
        "example": {
          "node_title": "This is a node",
          "keywords": [
            "keyword1",
            "keyword2"
          ],
          "coordinates": [
            [
              1,
              2,
              3,
              4
            ],
            [
              5,
              6,
              7,
              8
            ]
          ]
        }
      },
      "conceptTracksNodeSuggestion": {
        "type": "object",
        "properties": {
          "title": {
            "type": "string"
          },
          "id": {
            "type": "string"
          },
          "pages": {
            "type": "array",
            "items": {
              "oneOf": [
                {
                  "type": "integer"
                },
                {
                  "$ref": "#/components/schemas/conceptTracksNodeDetail"
                }
              ]
            }
          }
        },
        "example": {
          "title": "Sun dog",
          "id": "e4cc04f3-f5ed-49f1-be63-482204f14180",
          "pages": [
            0
          ]
        }
      },
      "conceptTracksNodeSuggestionsResponse": {
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/conceptTracksNodeSuggestion"
        }
      },
      "conceptTracksNodeDetailsResponse": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string"
          }
        },
        "required": [
          "status"
        ],
        "example": {
          "status": "in_progress"
        }
      },
      "conceptTracksModelRequestResponse": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string"
          }
        },
        "required": [
          "status"
        ],
        "example": {
          "status": "in_progress"
        }
      },
      "pdf2TextIndexingStatusResponse": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string",
            "enum": [
              "in_progress",
              "success",
              "failed"
            ]
          }
        },
        "required": [
          "status"
        ],
        "example": {
          "status": "in_progress"
        }
      },
      "questionGenerationQuery": {
        "type": "object",
        "properties": {
          "text": {
            "type": "string"
          },
          "request_type": {
            "type": "string",
            "enum": [
              "multiple_questions",
              "fill_in_blanks",
              "mcq"
            ]
          },
          "previous_question": {
            "type": "string"
          }
        },
        "required": [
          "text",
          "request_type"
        ],
        "example": {
          "text": "The North East Line is a high-capacity Mass Rapid Transit (MRT) line in Singapore. Operated by SBS Transit, the 20-kilometre (12 mi) line runs from HarbourFront station in southern Singapore to Punggol station in the northeast via Chinatown, Little India, Serangoon and Hougang. Completed at a cost of S$5 billion, the line began operating 14 of its 16 stations on 20 June 2003.",
          "request_type": "mcq"
        }
      },
      "questionGenerationResponseMultipleQuestions": {
        "type": "object",
        "properties": {
          "questions": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "answers": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        },
        "required": [
          "questions",
          "answers"
        ],
        "example": {
          "questions": [
            "What is a corpus?",
            "How the corpus should be constructed?",
            "What data is used to build the corpus?"
          ],
          "answers": [
            "A corpus is a collection of linguistic data.",
            "It should be constructed so as to be balanced and representative.",
            "Linguistic data which was not originally produced for the process of linguistic analysis."
          ]
        }
      },
      "questionGenerationResponseMCQs": {
        "type": "object",
        "properties": {
          "questions": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "mcq_answers": {
            "type": "array",
            "items": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          "correct_answers": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "explanations": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        },
        "required": [
          "questions",
          "mcq_answers",
          "correct_answers",
          "explanations"
        ],
        "example": {
          "questions": [
            "Which theory did Darwin discover?",
            "Which theory did Einstein discover?"
          ],
          "mcq_answers": [
            [
              "Evolution.",
              "Evaluation.",
              "Optimization.",
              "Quantization."
            ],
            [
              "Relativity",
              "Relativism",
              "Relevantism",
              "Irrelevantism"
            ]
          ],
          "correct_answers": [
            "Evolution.",
            "Relativity"
          ],
          "explanations": [
            "Darwin uncovered the theory of evolution.",
            "Einstein discovered relativity, both special and general."
          ]
        }
      },
      "freeformGraderQuery": {
        "type": "object",
        "properties": {
          "question": {
            "type": "string"
          },
          "student_answer": {
            "type": "string"
          },
          "model_answer": {
            "type": "string"
          }
        },
        "required": [
          "question",
          "student_answer",
          "model_answer"
        ],
        "example": {
          "question": "What is a cryptocurrency?",
          "student_answer": "Cryptocurrency is a physical coin minted by governments, based on the gold standard, which needs a centralized bank for all transactions and validations.",
          "model_answer": "Cryptocurrency is a digital or virtual currency that uses cryptography for security and operates on a decentralized platform, typically based on blockchain technology."
        }
      },
      "freeformGraderResponse": {
        "type": "object",
        "properties": {
          "score": {
            "type": "integer"
          },
          "explanation": {
            "type": "string"
          }
        },
        "required": [
          "score",
          "explanation"
        ],
        "example": {
          "score": 80,
          "explanation": "student got the answer roughly right."
        }
      }
    },
    "securitySchemes": {
      "api_key": {
        "type": "apiKey",
        "name": "x-api-key",
        "in": "header"
      }
    }
  }
}